{"remainingRequest":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\src\\myView\\personnel\\personnel.vue?vue&type=style&index=0&id=2627a96c&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\src\\myView\\personnel\\personnel.vue","mtime":1618900081674},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\less-loader\\dist\\cjs.js","mtime":1618890448194},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618890453389},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n/deep/.ivu-card-head {\r\n  border: none;\r\n}\r\n.card1 {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n/deep/ .ivu-btn-primary .ivu-btn-error {\r\n  width: 56px;\r\n}\r\n/deep/ .ivu-btn-primary {\r\n  margin-right: 10px;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n}\r\n.card2 {\r\n  margin-top: 10px;\r\n}\r\n.gjz {\r\n  margin-left: 20px;\r\n}\r\n.gjzbtn {\r\n  margin-left: 20px;\r\n}\r\n.dateRange {\r\n  display: flex;\r\n  justify-content: start;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n}\r\n",{"version":3,"sources":["personnel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"personnel.vue","sourceRoot":"src\\myView\\personnel","sourcesContent":["<template>\r\n  <div class=\"personnel\">\r\n    <Card>\r\n      <div class=\"card1\">\r\n        <h3>人员管理</h3>\r\n        <div class=\"head_botton\">\r\n          <Button type=\"primary\">新建</Button>\r\n          <Button type=\"error\">删除</Button>\r\n        </div>\r\n      </div>\r\n\r\n    </Card>\r\n\r\n    <Card class=\"card2\">\r\n      <div class=\"dateRange\">\r\n        <p>日期范围：</p>\r\n        <div class=\"date\">\r\n          <DatePicker style=\"width:160px\"\r\n                      type=\"date\"\r\n                      format=\"yyyy-MM-dd\"\r\n                      :value='startTime'\r\n                      @on-change='myStartTime'\r\n                      placeholder=\"开始日期\"></DatePicker>\r\n          <span>~</span>\r\n          <DatePicker style=\"width:160px;margin-right:20px;\"\r\n                      type=\"date\"\r\n                      format=\"yyyy-MM-dd\"\r\n                      :value='endTime'\r\n                      @on-change='myEndTime'\r\n                      placeholder=\"结束日期\"></DatePicker>\r\n        </div>\r\n        <p class=\"gjz\">关键字：</p>\r\n        <Input placeholder=\"请输入姓名/手机号\"\r\n               v-model.trim='searchText'\r\n               style=\"width:200px;margin-right:20px;\"></Input>\r\n        <Button type=\"primary\"\r\n                class=\"gjzbtn\">搜索</Button>\r\n      </div>\r\n      <Table size=\"large\"\r\n             @on-selection-change=\"selectOption\"\r\n             stripe\r\n             ref=\"selection\"\r\n             :columns=\"tableCol\"\r\n             :data=\"tableData\">></Table>\r\n      <Page class='mt-10 text-right'\r\n            :total=\"total\"\r\n            :current='currentPage'\r\n            :page-size='pageSize'\r\n            @on-change=\"changePage\"\r\n            @on-page-size-change=\"changeSize\"\r\n            show-sizer\r\n            show-total />\r\n    </Card>\r\n    <Modal v-model=\"saveItem\"\r\n           :title=\"itemTitle\"\r\n           @on-cancel='closeSaveItem'>\r\n      <Form ref=\"formData\"\r\n            :model=\"formData\"\r\n            :label-width=\"80\">\r\n        <input type=\"hidden\"\r\n               name='id'\r\n               v-model=\"formData.id\">\r\n        <FormItem label=\"姓名\">\r\n          <Input v-model=\"formData.name\"\r\n                 placeholder=\"请填写您的姓名\"\r\n                 :maxlength=\"10\"></Input>\r\n        </FormItem>\r\n        <span style=\"color: red;margin-left: 80px;font-size:5px\">*手机号为您的登录账号*</span>\r\n        <FormItem label=\"手机号\">\r\n          <Input v-model=\"formData.phone\"\r\n                 placeholder=\"请填写您的手机号码\"\r\n                 :maxlength=\"11\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"密码\"\r\n                  v-if='addUser'>\r\n          <Input type='password'\r\n                 v-model=\"formData.password\"\r\n                 placeholder=\"请填写您的密码\"\r\n                 :maxlength=\"11\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"确认密码\"\r\n                  v-if='addUser'>\r\n          <Input type='password'\r\n                 v-model=\"formData.confirmPwd\"\r\n                 placeholder=\"请确认密码\"\r\n                 :maxlength=\"11\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"任教课程\">\r\n          <Row>\r\n            <Col span=\"12\"\r\n                 style=\"padding-right:10px\">\r\n            <Select v-model=\"formData.subjectId\"\r\n                    filterable>\r\n              <Option v-for=\"item in cityList\"\r\n                      :value=\"item.id\"\r\n                      :key=\"item.id\">{{ item.name }}</Option>\r\n            </Select>\r\n            </Col>\r\n          </Row>\r\n        </FormItem>\r\n        <FormItem label=\"任教班级\">\r\n          <Transfer :data=\"coursesList\"\r\n                    :targetKeys=\"targetKeys\"\r\n                    :list-style=\"listStyle\"\r\n                    :render-format=\"render\"\r\n                    :operations=\"['移除','添加']\"\r\n                    filterable\r\n                    @on-change=\"handleChange\">\r\n          </Transfer>\r\n        </FormItem>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"default\"\r\n                @click=\"closeSaveItem\">关闭</Button>\r\n        <Button type=\"primary\"\r\n                :disabled='saveItemStatu'\r\n                @click=\"saveItemOk\">确认</Button>\r\n      </div>\r\n    </Modal>\r\n\r\n  </div>\r\n</template>\r\n<script>\r\nimport { hasOneOf } from '@/libs/tools' //权限\r\nimport {\r\n  teacherTableData, //教师数据\r\n  updateTeacher, //修改数据\r\n  commentDel, //删除数据\r\n  addTeacher, //添加数据\r\n  getAllClass, //\r\n} from '@/api/data'\r\nexport default {\r\n  //  http://localhost:8080/api/teacher/openTeacherTable   post\r\n\r\n  data() {\r\n    return {\r\n      startTime: '', // 日期初始化\r\n      endTime: '', // 日期初始化\r\n      searchText: '', // 搜索内容初始化\r\n      pageSize: 10,\r\n      currentPage: 1,\r\n      total: 1,\r\n\r\n      formData: {}, //表单信息\r\n      addUser: true, //是否为新增用户\r\n\r\n      saveItem: false, //保存操作框\r\n      saveItemStatu: false, //保存点击状态\r\n      itemTitle: '新建教师', //保存操作框title\r\n\r\n      selectItemArr: [], //选中项id\r\n      tableCol: [\r\n        //多选框\r\n        {\r\n          type: 'selection',\r\n          width: 60,\r\n          align: 'center',\r\n        },\r\n\r\n        {\r\n          title: '注册时间',\r\n          key: 'createTimeStr',\r\n        },\r\n        {\r\n          title: '姓名',\r\n          key: 'name',\r\n        },\r\n        {\r\n          title: '手机号',\r\n          key: 'phone',\r\n        },\r\n        {\r\n          title: '主教课程',\r\n          key: 'classEnumString',\r\n        },\r\n        {\r\n          width: 100,\r\n          title: '操作',\r\n          key: 'examineStatus',\r\n          checkAccess: ['superAdmin'],\r\n          render: (h, params) => {\r\n            console.log()\r\n            return h('div', [\r\n              h(\r\n                'Button',\r\n                {\r\n                  props: {\r\n                    type: 'primary',\r\n                    size: 'large',\r\n                    disabled: this.viewAccessTeacher,\r\n                  },\r\n                  on: {\r\n                    click: () => {\r\n                      let getData = JSON.parse(\r\n                        JSON.stringify(this.tableData[params.index])\r\n                      )\r\n                      this.formData = getData\r\n\r\n                      this.itemTitle = '编辑教师信息'\r\n                      if (this.formData.courses.length > 0) {\r\n                        for (var j in this.formData.courses) {\r\n                          this.targetKeys.push(this.formData.courses[j].id)\r\n                        }\r\n                      }\r\n\r\n                      this.addUser = false\r\n                      this.saveItem = true\r\n                      if (this.cityList.length >= 1) {\r\n                        return\r\n                      }\r\n\r\n                      getAllClass().then((res) => {\r\n                        if (res.data.success) {\r\n                          this.cityList = res.data.result.clasies\r\n                          //   this.classList = res.data.result.courses\r\n                          //   console.log(JSON.stringify(this.classList))\r\n                          var coursesArr = res.data.result.courses\r\n                          for (var i in coursesArr) {\r\n                            var objCourses = {}\r\n                            objCourses.key = coursesArr[i].id\r\n                            objCourses.label = coursesArr[i].className\r\n                            this.coursesList.push(objCourses)\r\n                          }\r\n                        } else if (res.data.errorMsg) {\r\n                          this.$Message.warning({\r\n                            content: res.data.errorMsg,\r\n                          })\r\n                        }\r\n                      })\r\n                    },\r\n                  },\r\n                },\r\n                '编辑'\r\n              ),\r\n            ])\r\n          },\r\n        },\r\n      ],\r\n      tableData: [],\r\n    }\r\n  },\r\n  methods: {\r\n    async pageInit() {\r\n      teacherTableData(\r\n        this.pageSize,\r\n        this.currentPage,\r\n        this.startTime,\r\n        this.endTime,\r\n        this.searchText\r\n      ).then((res) => {\r\n        if (res.data.success) {\r\n          this.total = res.data.result.data.totalSize\r\n          this.tableData = res.data.result.data.pageList\r\n        } else if (res.data.errorMsg) {\r\n          this.$Message.warning({\r\n            content: res.data.errorMsg,\r\n          })\r\n        }\r\n      })\r\n    },\r\n    changePage(page) {\r\n      this.currentPage = page\r\n      this.pageInit()\r\n    },\r\n    changeSize(size) {\r\n      this.pageSize = size\r\n      this.currentPage = 1\r\n      this.pageInit()\r\n    },\r\n    addItem() {\r\n      this.formData = {}\r\n      this.itemTitle = '添加教师'\r\n      this.addUser = true\r\n      this.saveItem = true\r\n      if (this.cityList.length >= 1) {\r\n        return\r\n      }\r\n      getAllClass().then((res) => {\r\n        if (res.data.success) {\r\n          this.cityList = res.data.result.clasies\r\n          //this.classList = res.data.result.courses;\r\n          // console.log(JSON.stringify(\"+++\"+this.classList))\r\n          var coursesArr = res.data.result.courses\r\n          for (var i in coursesArr) {\r\n            var objCourses = {}\r\n            objCourses.key = coursesArr[i].id\r\n            objCourses.label = coursesArr[i].className\r\n            this.coursesList.push(objCourses)\r\n          }\r\n        } else {\r\n          this.$Message.warning({\r\n            content: res.data.errorMsg,\r\n          })\r\n        }\r\n      })\r\n    },\r\n    // 关闭保存项目模态框\r\n    closeSaveItem() {\r\n      this.formData = {}\r\n      this.saveItem = false\r\n      this.targetKeys = []\r\n    },\r\n    saveItemOk() {\r\n      var that = this\r\n      var formData = this.formData\r\n      //console.log(JSON.stringify(formData))\r\n      if (!formData.name) {\r\n        this.$Message.warning({\r\n          content: '请填写您的姓名！',\r\n        })\r\n        return\r\n      } else if (!/[\\u4e00-\\u9fa5_a-zA-Z]+$/.test(formData.name)) {\r\n        this.$Message.warning({\r\n          content: '请填写正确的姓名',\r\n        })\r\n        return\r\n      }\r\n\r\n      if (!formData.phone) {\r\n        this.$Message.warning({\r\n          content: '请填写您的手机号',\r\n        })\r\n        return\r\n      } else if (!/^1(3|4|5|6|7|8)\\d{9}$/.test(formData.phone)) {\r\n        this.$Message.warning({\r\n          content: '请填写正确的手机号',\r\n        })\r\n        return\r\n      }\r\n\r\n      if (this.addUser) {\r\n        if (!formData.password) {\r\n          this.$Message.warning({\r\n            content: '请填写您的密码！',\r\n          })\r\n          return\r\n        } else if (!/^[\\w_-]{5,11}$/.test(formData.password)) {\r\n          this.$Message.warning({\r\n            content: '请填写5-11密码',\r\n          })\r\n          return\r\n        }\r\n        if (!formData.confirmPwd) {\r\n          this.$Message.warning({\r\n            content: '请确认您的密码！',\r\n          })\r\n          return\r\n        } else if (formData.confirmPwd !== formData.password) {\r\n          this.$Message.warning({\r\n            content: '两次密码请保持一致',\r\n          })\r\n          return\r\n        }\r\n\r\n        if (!formData.subjectId) {\r\n          this.$Message.warning({\r\n            content: '请选择任教课程',\r\n          })\r\n          return\r\n        }\r\n\r\n        if (!this.targetKeys) {\r\n          this.$Message.warning({\r\n            content: '请选择任教班级',\r\n          })\r\n          return\r\n        }\r\n        addTeacher(this.formData, this.targetKeys).then((res) => {\r\n          // console.log(JSON.stringify(res))\r\n          if (res.data.result && res.data.result.error) {\r\n            this.$Message.warning({\r\n              content: res.data.result.error,\r\n            })\r\n            return\r\n          } else if (res.data.success) {\r\n            this.$Message.success({\r\n              content: '保存用户成功',\r\n            })\r\n            that.saveItem = false\r\n            that.pageInit()\r\n          } else if (res.data.errorMsg) {\r\n            this.$Message.warning({\r\n              content: res.data.errorMsg,\r\n            })\r\n          }\r\n          that.saveItemStatu = false\r\n        })\r\n      } else {\r\n        this.saveItemStatu = true\r\n        updateTeacher(this.formData, this.targetKeys).then((res) => {\r\n          // var that = this;\r\n          that.saveItemStatu = false\r\n          if (res.data.success) {\r\n            this.$Message.success({\r\n              content: '修改用户成功',\r\n            })\r\n            that.saveItem = false\r\n            that.pageInit()\r\n          } else if (res.data.errorMsg) {\r\n            this.$Message.warning({\r\n              content: res.data.errorMsg,\r\n            })\r\n          }\r\n        })\r\n      }\r\n    },\r\n    //选中项\r\n    selectOption(selection, row) {\r\n      this.selectItemArr = []\r\n      for (let item of selection) {\r\n        this.selectItemArr.push(item.id)\r\n      }\r\n    },\r\n    // 删除\r\n    myDelete() {\r\n      var selectItemArr = this.selectItemArr\r\n      if (selectItemArr.length < 1) {\r\n        this.$Message.warning({\r\n          content: '请选择项目！',\r\n        })\r\n        return\r\n      }\r\n      commentDel('/teacher/delTeacherById', selectItemArr).then((res) => {\r\n        console.log(JSON.stringify(res))\r\n        if (res.data.success) {\r\n          this.selectItemArr = []\r\n          this.pageInit()\r\n          this.$Message.success({\r\n            content: '删除成功！',\r\n          })\r\n        } else if (res.data.errorMsg) {\r\n          this.$Message.warning({\r\n            content: res.data.errorMsg,\r\n          })\r\n        }\r\n\r\n        // this.tableData = res.data.result.data.pageList;\r\n      })\r\n    },\r\n    // 开始日期\r\n    myStartTime(newTime) {\r\n      this.startTime = newTime\r\n    },\r\n    // 结束日期\r\n    myEndTime(newTime) {\r\n      this.endTime = newTime\r\n    },\r\n    // 搜索\r\n    search() {\r\n      this.currentPage = 1\r\n      this.pageInit()\r\n    },\r\n    handleChange(newTargetKeys) {\r\n      this.targetKeys = newTargetKeys\r\n    },\r\n    render(item) {\r\n      return item.label\r\n    },\r\n    reloadMockData() {\r\n      this.transfer = this.getMockData()\r\n      this.targetKeys = this.getTargetKeys()\r\n    },\r\n  },\r\n  mounted() {\r\n    // 初始化\r\n    teacherTableData(10, 1).then((res) => {\r\n      //   console.log('----' + JSON.stringify(res))\r\n      if (res.data.success) {\r\n        this.total = res.data.result.data.totalSize\r\n        this.tableData = res.data.result.data.pageList\r\n      } else if (res.data.errorMsg) {\r\n        this.$Message.warning({\r\n          content: res.data.errorMsg,\r\n        })\r\n      }\r\n    })\r\n    // 图片上传\r\n    // this.uploadList = this.$refs.upload.fileList;\r\n  },\r\n  computed: {\r\n    access() {\r\n      return this.$store.state.user.access\r\n    },\r\n    //所有权限\r\n    viewAccessAll() {\r\n      return hasOneOf(['superAdmin', 'teacher', 'student'], this.access)\r\n    },\r\n    //部分权限\r\n    viewAccessTeacher() {\r\n      return hasOneOf(['teacher', 'student'], this.access)\r\n    },\r\n    Super() {\r\n      return hasOneOf(['superAdmin'], this.access)\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/deep/.ivu-card-head {\r\n  border: none;\r\n}\r\n.card1 {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n/deep/ .ivu-btn-primary .ivu-btn-error {\r\n  width: 56px;\r\n}\r\n/deep/ .ivu-btn-primary {\r\n  margin-right: 10px;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n}\r\n.card2 {\r\n  margin-top: 10px;\r\n}\r\n.gjz {\r\n  margin-left: 20px;\r\n}\r\n.gjzbtn {\r\n  margin-left: 20px;\r\n}\r\n.dateRange {\r\n  display: flex;\r\n  justify-content: start;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n}\r\n</style>>\r\n"]}]}