{"remainingRequest":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\src\\view\\login\\login.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\src\\view\\login\\login.vue","mtime":1567648062360},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\less-loader\\dist\\cjs.js","mtime":1618890448194},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618890453389},{"path":"C:\\Users\\茹家豪\\Desktop\\20210416_rujh_vue\\20210416_rujh_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n@import './login.less';\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";AACA","file":"login.vue","sourceRoot":"src\\view\\login","sourcesContent":["<style lang=\"less\">\r\n  @import './login.less';\r\n</style>\r\n\r\n<template>\r\n  <div class=\"login\">\r\n    <div class=\"login-con\">\r\n      <Card icon=\"log-in\" title=\"欢迎登录\" :bordered=\"false\">\r\n        <div class=\"form-con\">\r\n          <login-form @on-success-valid=\"handleSubmit\"></login-form>\r\n          <Button style='margin-bottom: 10px;' @click=\"saveItem = true\" long>注册</Button>\r\n          <p class=\"login-tip\">输入用户名和密码</p>\r\n        </div>\r\n\r\n      </Card>\r\n    </div>\r\n    <Modal\r\n        v-model=\"saveItem\"\r\n        :title=\"itemTitle\"\r\n        @on-cancel='closeSaveItem'>\r\n        <Form ref=\"formData\" :model=\"formData\" :label-width=\"80\">\r\n          <FormItem label=\"姓名\">\r\n            <Input v-model=\"formData.name\" placeholder=\"请填写您的姓名\" :maxlength=\"10\"></Input>\r\n        </FormItem>\r\n          <FormItem label=\"手机号\">\r\n              <Input v-model=\"formData.phone\" placeholder=\"请填写您的手机号码\" :maxlength=\"11\"></Input>\r\n          </FormItem>\r\n           <FormItem label=\"密码\">\r\n              <Input type='password' v-model=\"formData.password\" placeholder=\"请填写您的密码\" :maxlength=\"11\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"确认密码\">\r\n             <Input type='password' v-model=\"formData.confirmPwd\" placeholder=\"请确认密码\" :maxlength=\"11\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"注册身份\">\r\n              <RadioGroup v-model=\"formData.identity\">\r\n                  <Radio :label=\"1\" :key=\"1\"><span>学生</span></Radio>\r\n                  <Radio :label=\"0\" :key=\"0\"><span>老师</span></Radio>\r\n              </RadioGroup>\r\n          </FormItem>\r\n          <FormItem label=\"任教课程\" v-if=\"formData.identity==0\">\r\n             <Row>\r\n                <Col span=\"12\" style=\"padding-right:10px\">\r\n                    <Select v-model=\"formData.subjectId\" filterable>\r\n                        <Option v-for=\"item in cityList\" :value=\"item.id\" :key=\"item.id\">{{ item.name }}</Option>\r\n                    </Select>\r\n                </Col>\r\n            </Row>\r\n          </FormItem>\r\n        </Form>\r\n        <div slot=\"footer\">\r\n            <Button type=\"default\"  @click=\"closeSaveItem\">关闭</Button>\r\n            <Button type=\"primary\" :disabled='saveItemStatu'  @click=\"saveItemOk\">确认</Button>\r\n        </div>\r\n      </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LoginForm from '_c/login-form'\r\nimport { mapActions } from 'vuex'\r\nimport { regist,getAllClass} from '@/api/data'\r\nexport default {\r\n  data () {\r\n    return {\r\n      saveItem:false,     //保存操作框\r\n      saveItemStatu:false,     //保存点击状态\r\n      itemTitle:'注册',   //保存操作框title\r\n      // identity: '学生',\r\n      formData:{\r\n        identity:1\r\n      },\r\n      cityList: []\r\n    }\r\n  },\r\n  components: {\r\n    LoginForm\r\n  },\r\n  methods: {\r\n    ...mapActions([\r\n      'handleLogin',\r\n      'getUserInfo'\r\n    ]),\r\n    handleSubmit ({ userName, password }) {\r\n      this.handleLogin({ userName, password }).then(res => {\r\n        this.getUserInfo().then(res => {\r\n          this.$router.push({\r\n            name: this.$config.homeName\r\n          })\r\n        })\r\n      })\r\n    },\r\n    // 关闭保存项目模态框\r\n    closeSaveItem(){\r\n      this.formData = {};\r\n      this.saveItem = false;\r\n    },\r\n    saveItemOk(){\r\n      var that = this;\r\n      var formData = this.formData;\r\n      console.log(JSON.stringify(formData))\r\n      if(!formData.name){\r\n        this.$Message.warning({\r\n          content:'请填写您的姓名！'\r\n        });\r\n        return;\r\n      }else if (!/[\\u4e00-\\u9fa5_a-zA-Z]+$/.test(formData.name)){\r\n        this.$Message.warning({\r\n          content:'请填写正确的姓名'\r\n        });\r\n        return;\r\n      };\r\n      \r\n      if(!formData.phone){\r\n        this.$Message.warning({\r\n          content:'请填写您的手机号'\r\n        });\r\n        return;\r\n      }else if (!/^1(3|4|5|6|7|8)\\d{9}$/.test(formData.phone)){\r\n        this.$Message.warning({\r\n          content:'请填写正确的手机号'\r\n        });\r\n        return;\r\n      };\r\n\r\n        if(!formData.password){\r\n          this.$Message.warning({\r\n            content:'请填写您的密码！'\r\n          });\r\n          return;\r\n        }else if (!/^[\\w_-]{5,11}$/.test(formData.password)){\r\n          this.$Message.warning({\r\n            content:'请填写5-11密码'\r\n          });\r\n          return;\r\n        };\r\n        if(!formData.confirmPwd){\r\n          this.$Message.warning({\r\n            content:'请确认您的密码！'\r\n          });\r\n          return;\r\n        }else if (formData.confirmPwd !== formData.password){\r\n          this.$Message.warning({\r\n            content:'两次密码请保持一致'\r\n          });\r\n          return;\r\n        };\r\n        //console.log(JSON.stringify(this.identity))\r\n        regist(this.formData).then(res => {\r\n           console.log(JSON.stringify(res))\r\n          if(res.data.result && res.data.result.error){\r\n            this.$Message.warning({\r\n              content:res.data.result.error\r\n            })\r\n            return;\r\n          }else if(res.data.success){\r\n            this.$Message.success({\r\n              content:'注册用户成功'\r\n            });\r\n            that.saveItem = false;\r\n            that.pageInit();\r\n          }else if(res.data.errorMsg){\r\n            this.$Message.warning({\r\n              content:res.data.errorMsg\r\n            })\r\n          }\r\n          that.saveItemStatu = false;\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    // 初始化\r\n    getAllClass().then(res => {\r\n       //console.log(\"----\"+JSON.stringify(res));\r\n      if(res.data.success){\r\n       this.cityList = res.data.result.clasies; \r\n      }else if(res.data.errorMsg){\r\n        this.$Message.warning({\r\n          content:res.data.errorMsg\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n</script>\r\n"]}]}